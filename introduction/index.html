

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introduction &mdash; Pykka v0.12.2 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.12.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Pykka v0.12.2 documentation" href="../" />
    <link rel="next" title="Pykka API" href="../api/" />
    <link rel="prev" title="Pykka" href="../" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../api/" title="Pykka API"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../" title="Pykka"
             accesskey="P">previous</a> |</li>
        <li><a href="../">Pykka v0.12.2 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-actor-model">
<h2>The actor model<a class="headerlink" href="#the-actor-model" title="Permalink to this headline">¶</a></h2>
<p>An actor has the following characteristics:</p>
<ul class="simple">
<li>It does not share state with anybody else.</li>
<li>It can have its own state.</li>
<li>It can only communicate with other actors by sending and receiving
messages.</li>
<li>It can only send messages to actors whose address it has.</li>
<li>When an actor receives a message it may take actions like:<ul>
<li>altering its own state, e.g. so that it can react differently to a
future message,</li>
<li>sending messages to other actors, or</li>
<li>starting new actors.</li>
</ul>
</li>
<li>None of the actions are required, and they may be applied in any order.</li>
<li>It only processes one message at a time. In other words, a single actor
does not give you any concurrency, and it does not need to use e.g. locks
to protect its own state.</li>
</ul>
<p>In Pykka, we have two different ways to use actors: plain actors and typed
actors.</p>
</div>
<div class="section" id="plain-actors">
<h2>Plain actors<a class="headerlink" href="#plain-actors" title="Permalink to this headline">¶</a></h2>
<p>Pykka&#8217;s plain actors get all incoming messages delivered to the
<tt class="xref py py-meth docutils literal"><span class="pre">on_receive()</span></tt> method. This method can decide what action is needed in
response to the message. The messages are expected to be Python dictionaries,
containing anything that can be serialized.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#! /usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">pykka.actor</span> <span class="kn">import</span> <span class="n">ThreadingActor</span>

<span class="k">class</span> <span class="nc">PlainActor</span><span class="p">(</span><span class="n">ThreadingActor</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stored_messages</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">on_receive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;command&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;get_messages&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stored_messages</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stored_messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">actor</span> <span class="o">=</span> <span class="n">PlainActor</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">send_one_way</span><span class="p">({</span><span class="s">&#39;no&#39;</span><span class="p">:</span> <span class="s">&#39;Norway&#39;</span><span class="p">,</span> <span class="s">&#39;se&#39;</span><span class="p">:</span> <span class="s">&#39;Sweden&#39;</span><span class="p">})</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">send_one_way</span><span class="p">({</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">})</span>
    <span class="k">print</span> <span class="n">actor</span><span class="o">.</span><span class="n">send_request_reply</span><span class="p">({</span><span class="s">&#39;command&#39;</span><span class="p">:</span> <span class="s">&#39;get_messages&#39;</span><span class="p">})</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
<p>We get the following output:</p>
<div class="highlight-python"><pre>$ PYTHONPATH=. python examples/plain_actor.py
[{'se': 'Sweden', 'no': 'Norway'}, {'a': 3, 'c': 5, 'b': 4}]</pre>
</div>
</div>
<div class="section" id="typed-actors">
<h2>Typed actors<a class="headerlink" href="#typed-actors" title="Permalink to this headline">¶</a></h2>
<p>If you wrap a plain actor in a <a class="reference internal" href="../api/#pykka.proxy.ActorProxy" title="pykka.proxy.ActorProxy"><tt class="xref py py-class docutils literal"><span class="pre">pykka.proxy.ActorProxy</span></tt></a>, Pykka let you
call methods on the actor like you would on a regular object, but it runs the
code in the actor. Similarly, when you access the actor&#8217;s fields, they are read
in the actor, serialized and copied to the reader.</p>
<p>Both method calling and attribute reads immediately returns future objects.
This means that your code can continue while the result is calculated in some
other actor, and that you&#8217;re code will not block until you actually use the
returned value.</p>
<p>Here is a small example of two actors wrapped in
<a class="reference internal" href="../api/#pykka.proxy.ActorProxy" title="pykka.proxy.ActorProxy"><tt class="xref py py-class docutils literal"><span class="pre">pykka.proxy.ActorProxy</span></tt></a> objects. It may look like they communicate with
each other by calling regular methods, but&#8211;under the hood&#8211;the calls are
serialized and sent to the other actor. Meanwhile, the first actor can continue
executing its own code.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#! /usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">pykka.actor</span> <span class="kn">import</span> <span class="n">ThreadingActor</span>
<span class="kn">from</span> <span class="nn">pykka.registry</span> <span class="kn">import</span> <span class="n">ActorRegistry</span>

<span class="k">class</span> <span class="nc">Adder</span><span class="p">(</span><span class="n">ThreadingActor</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">add_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s"> is increasing </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>

<span class="k">class</span> <span class="nc">Bookkeeper</span><span class="p">(</span><span class="n">ThreadingActor</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">adder</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adder</span> <span class="o">=</span> <span class="n">adder</span>

    <span class="k">def</span> <span class="nf">count_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">target</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adder</span><span class="o">.</span><span class="n">add_one</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="k">print</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s"> got </span><span class="si">%d</span><span class="s"> back&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">adder</span> <span class="o">=</span> <span class="n">Adder</span><span class="o">.</span><span class="n">start</span><span class="p">()</span><span class="o">.</span><span class="n">proxy</span><span class="p">()</span>
    <span class="n">bookkeeper</span> <span class="o">=</span> <span class="n">Bookkeeper</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">adder</span><span class="p">)</span><span class="o">.</span><span class="n">proxy</span><span class="p">()</span>
    <span class="n">bookkeeper</span><span class="o">.</span><span class="n">count_to</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">ActorRegistry</span><span class="o">.</span><span class="n">stop_all</span><span class="p">()</span>
</pre></div>
</div>
<p>When we run the above example with Pykka on the <span class="target" id="index-0"></span><tt class="xref std std-envvar docutils literal"><span class="pre">PYTHONPATH</span></tt>, we get
the following output:</p>
<div class="highlight-python"><pre>$ PYTHONPATH=. python examples/counter.py
Adder (urn:uuid:35d5216f-332b-4c04-97bb-a02016ba4121) is increasing 0
Bookkeeper (urn:uuid:fd8df21d-8a58-451b-a1b8-77bd19d868b8) got 1 back
Adder (urn:uuid:35d5216f-332b-4c04-97bb-a02016ba4121) is increasing 1
Bookkeeper (urn:uuid:fd8df21d-8a58-451b-a1b8-77bd19d868b8) got 2 back
Adder (urn:uuid:35d5216f-332b-4c04-97bb-a02016ba4121) is increasing 2
Bookkeeper (urn:uuid:fd8df21d-8a58-451b-a1b8-77bd19d868b8) got 3 back
Adder (urn:uuid:35d5216f-332b-4c04-97bb-a02016ba4121) is increasing 3
Bookkeeper (urn:uuid:fd8df21d-8a58-451b-a1b8-77bd19d868b8) got 4 back
Adder (urn:uuid:35d5216f-332b-4c04-97bb-a02016ba4121) is increasing 4
Bookkeeper (urn:uuid:fd8df21d-8a58-451b-a1b8-77bd19d868b8) got 5 back
Adder (urn:uuid:35d5216f-332b-4c04-97bb-a02016ba4121) is increasing 5
Bookkeeper (urn:uuid:fd8df21d-8a58-451b-a1b8-77bd19d868b8) got 6 back
Adder (urn:uuid:35d5216f-332b-4c04-97bb-a02016ba4121) is increasing 6
Bookkeeper (urn:uuid:fd8df21d-8a58-451b-a1b8-77bd19d868b8) got 7 back
Adder (urn:uuid:35d5216f-332b-4c04-97bb-a02016ba4121) is increasing 7
Bookkeeper (urn:uuid:fd8df21d-8a58-451b-a1b8-77bd19d868b8) got 8 back
Adder (urn:uuid:35d5216f-332b-4c04-97bb-a02016ba4121) is increasing 8
Bookkeeper (urn:uuid:fd8df21d-8a58-451b-a1b8-77bd19d868b8) got 9 back
Adder (urn:uuid:35d5216f-332b-4c04-97bb-a02016ba4121) is increasing 9
Bookkeeper (urn:uuid:fd8df21d-8a58-451b-a1b8-77bd19d868b8) got 10 back</pre>
</div>
<p>See the <tt class="docutils literal"><span class="pre">examples/</span></tt> dir for more runnable examples.</p>
<div class="section" id="traversable-attributes">
<h3>Traversable attributes<a class="headerlink" href="#traversable-attributes" title="Permalink to this headline">¶</a></h3>
<p>Sometimes you don&#8217;t care about the attribute of an actor, but you want to
access the attributes of the attribute itself, or call methods on the
attribute. For this case, Pykka supports traversable attributes. By marking an
actor attribute as traversable, Pykka will not return the attribute when
accessed, but wrap it in a new <a class="reference internal" href="../api/#pykka.proxy.ActorProxy" title="pykka.proxy.ActorProxy"><tt class="xref py py-class docutils literal"><span class="pre">pykka.proxy.ActorProxy</span></tt></a>. When the
wrapped attribute is used, Pykka will get/set attributes or call methods on the
actor attribute, just as it normally would on the actor, if wrapped in an actor
proxy.</p>
<p>To mark an attribute as traversable, simply set the <tt class="xref py py-attr docutils literal"><span class="pre">pykka_traversable</span></tt>
attribute to something, like e.g. <tt class="xref py py-class xref docutils literal"><span class="pre">True</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">AnActor</span><span class="p">(</span><span class="n">GeventActor</span><span class="p">):</span>
    <span class="n">an_attribute</span> <span class="o">=</span> <span class="n">SomeOtherObject</span><span class="p">()</span>
    <span class="n">an_attribute</span><span class="o">.</span><span class="n">pykka_traversable</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<p>You can mark the attributes of attributes of the actor as traversable, and so
on, as long as all objects in the path from the actor to the deepest nested
attribute is marked as traversable.</p>
</div>
</div>
<div class="section" id="logging">
<h2>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h2>
<p>Pykka uses Python&#8217;s standard <tt class="xref py py-mod docutils literal"><span class="pre">logging</span></tt> module for logging debug statements
and any unhandled exceptions in the actors. All log records emitted by Pykka
are issued to the logger named &#8220;pykka&#8221;, or a sublogger of it.</p>
<p>Out of the box, Pykka is set up with <tt class="xref py py-class docutils literal"><span class="pre">logging.NullHandler</span></tt> as the only
log record handler. This is the recommended approach for logging in
libraries, so that the application developer using the library will have full
control over how the log records from the library will be exposed to the
application&#8217;s users. In other words, if you want to see the log records from
Pykka anywhere, you need to add a useful handler to the root logger or the
logger named &#8220;pykka&#8221; to get any log output from Pykka. The defaults provided by
<tt class="xref py py-meth docutils literal"><span class="pre">logging.basicConfig()</span></tt> is enough to get debug log statements out of
Pykka:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">()</span>
</pre></div>
</div>
<p>If your application is already using <tt class="xref py py-mod docutils literal"><span class="pre">logging</span></tt>, and you want debug log
output from your own application, but not from Pykka, you can ignore debug log
messages from Pykka by increasing the threshold on the Pykka logger to &#8220;info&#8221;
level or higher:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&#39;pykka&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</pre></div>
</div>
<p>For more details on how to use <tt class="xref py py-mod docutils literal"><span class="pre">logging</span></tt>, please refer to the Python
standard library documentation.</p>
</div>
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>Pykka is licensed under the <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.</p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Install Pykka&#8217;s dependencies:</p>
<ul class="simple">
<li>Python 2.6 or greater. Python 3.x should work too if you don&#8217;t use gevent.</li>
<li>Optionally, <a class="reference external" href="http://www.gevent.org/">gevent</a>, if you want to use gevent
based actors from <a class="reference internal" href="../api/#module-pykka.gevent"><tt class="xref py py-mod docutils literal"><span class="pre">pykka.gevent</span></tt></a>.</li>
</ul>
<p>To install Pykka you can use pip:</p>
<div class="highlight-python"><pre>pip install pykka</pre>
</div>
<p>To upgrade your Pykka installation to the latest released version:</p>
<div class="highlight-python"><pre>pip install --upgrade pykka</pre>
</div>
<p>To install the latest development snapshot:</p>
<div class="highlight-python"><pre>pip install pykka==dev</pre>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction</a><ul>
<li><a class="reference internal" href="#the-actor-model">The actor model</a></li>
<li><a class="reference internal" href="#plain-actors">Plain actors</a></li>
<li><a class="reference internal" href="#typed-actors">Typed actors</a><ul>
<li><a class="reference internal" href="#traversable-attributes">Traversable attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#logging">Logging</a></li>
<li><a class="reference internal" href="#license">License</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../"
                        title="previous chapter">Pykka</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../api/"
                        title="next chapter">Pykka API</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/introduction.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search/" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../api/" title="Pykka API"
             >next</a> |</li>
        <li class="right" >
          <a href="../" title="Pykka"
             >previous</a> |</li>
        <li><a href="../">Pykka v0.12.2 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2010-2011, Stein Magnus Jodal.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.1.
    </div>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-22002334-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

  </body>
</html>